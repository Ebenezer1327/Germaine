<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Log in · Germaine & Snowy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#ff9ec9" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Germaine" />
    <link rel="apple-touch-icon" href="/icons/icon-192.png" />
  </head>
  <body class="auth-page">
    <div class="background-decoration background-decoration--left"></div>
    <div class="background-decoration background-decoration--right"></div>

    <main class="auth-container">
      <header class="auth-header">
        <h1 class="title">Welcome back, Germaine ✿</h1>
      </header>

      <section class="auth-card">
        <form class="auth-form" method="post" action="/login" id="loginForm">
          <div class="auth-field">
            <label for="username">Username</label>
            <input
              id="username"
              name="username"
              type="text"
              autocomplete="username"
              required
              placeholder="username"
            />
          </div>

          <div class="auth-field">
            <label for="password">Password</label>
            <div class="password-wrap">
              <input
                id="password"
                name="password"
                type="password"
                autocomplete="current-password"
                required
                placeholder="Your password"
              />
              <button type="button" class="password-toggle password-eye-btn" id="passwordToggle" title="Show password" aria-label="Show password" data-eye="open">
                <span class="password-toggle-icon-wrap">
                  <svg class="password-eye-svg" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" aria-hidden="true">
                    <path class="password-eye-outline" d="M12 5C7 5 3 12 3 12s4 7 9 7 9-7 9-7-4-7-9-7z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <g class="password-eye-iris" transform-origin="12px 12px">
                      <circle class="iris-base" cx="12" cy="12" r="4" fill="rgb(59, 48, 84)"/>
                      <circle class="iris-pupil" cx="12" cy="12" r="1.5" fill="black"/>
                      <circle class="iris-glare" cx="13" cy="11" r="0.7" fill="rgba(255,255,255,0.6)"/>
                    </g>
                    <line class="password-eye-closed" x1="4" y1="4" x2="20" y2="20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                </span>
              </button>
            </div>
          </div>

          <label class="auth-remember">
            <input type="checkbox" name="remember_me" id="rememberMe" value="1" />
            <span>Save login</span>
          </label>

          <button type="submit" class="btn btn--primary auth-submit">
            Log in
          </button>

        </form>
      </section>

      <a href="/" class="auth-back-link">← Back to countdown</a>
    </main>
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('SW registered:', reg.scope))
          .catch(err => console.log('SW registration failed:', err));
      }

      (function () {
        var passwordInput = document.getElementById('password');
        var passwordToggle = document.getElementById('passwordToggle');
        var loginForm = document.getElementById('loginForm');
        var usernameInput = document.getElementById('username');
        var rememberCheckbox = document.getElementById('rememberMe');
        var SAVED_USERNAME_KEY = 'germaine_saved_username';

        if (passwordToggle && passwordInput) {
          passwordToggle.addEventListener('click', function () {
            var isPassword = passwordInput.type === 'password';
            passwordInput.type = isPassword ? 'text' : 'password';
            passwordToggle.setAttribute('title', isPassword ? 'Hide password' : 'Show password');
            passwordToggle.setAttribute('aria-label', isPassword ? 'Hide password' : 'Show password');
            passwordToggle.setAttribute('data-eye', isPassword ? 'closed' : 'open');
            passwordToggle.classList.add('pop');
            var btn = passwordToggle;
            btn.addEventListener('animationend', function removePop() {
              btn.removeEventListener('animationend', removePop);
              btn.classList.remove('pop');
            });
          });
        }

        if (loginForm && rememberCheckbox) {
          loginForm.addEventListener('submit', function () {
            if (rememberCheckbox.checked && usernameInput.value.trim()) {
              try { localStorage.setItem(SAVED_USERNAME_KEY, usernameInput.value.trim()); } catch (e) {}
            } else {
              try { localStorage.removeItem(SAVED_USERNAME_KEY); } catch (e) {}
            }
          });
        }

        try {
          var saved = localStorage.getItem(SAVED_USERNAME_KEY);
          if (saved && usernameInput) {
            usernameInput.value = saved;
            if (rememberCheckbox) rememberCheckbox.checked = true;
          }
        } catch (e) {}
      })();
    </script>
  </body>
  </html>

